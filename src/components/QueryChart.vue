<template>
  <v-card>
    <v-list-item two-line>
      <v-list-item-content>
        <v-list-item-title class="headline"> Total Query </v-list-item-title>
        <!-- <v-list-item-subtitle>last 5 Minutes</v-list-item-subtitle> -->
      </v-list-item-content>
      <v-list-item-action>
        <v-row>
          <v-col cols="5">
            <v-menu
              ref="menu"
              v-model="menuFrom"
              :close-on-content-click="false"
              :return-value.sync="dateFrom"
              transition="scale-transition"
              offset-y
              min-width="auto"
            >
              <template v-slot:activator="{ on, attrs }">
                <v-text-field
                  v-model="dateFrom"
                  label="From"
                  prepend-icon="mdi-calendar"
                  readonly
                  v-bind="attrs"
                  v-on="on"
                ></v-text-field>
              </template>
              <v-date-picker v-model="dateFrom" no-title scrollable>
                <v-spacer></v-spacer>
                <v-btn text color="primary" @click="menuTo = false">
                  Cancel
                </v-btn>
                <v-btn text color="primary" @click="$refs.menu.save(dateFrom)">
                  OK
                </v-btn>
              </v-date-picker>
            </v-menu>
          </v-col>
          <v-col cols="5">
            <v-menu
              ref="menu"
              v-model="menuTo"
              :close-on-content-click="false"
              :return-value.sync="dateTo"
              transition="scale-transition"
              offset-y
              min-width="auto"
            >
              <template v-slot:activator="{ on, attrs }">
                <v-text-field
                  v-model="dateTo"
                  label="To"
                  prepend-icon="mdi-calendar"
                  readonly
                  v-bind="attrs"
                  v-on="on"
                ></v-text-field>
              </template>
              <v-date-picker v-model="dateTo" no-title scrollable>
                <v-spacer></v-spacer>
                <v-btn text color="primary" @click="menuTo = false">
                  Cancel
                </v-btn>
                <v-btn text color="primary" @click="$refs.menu.save(dateTo)">
                  OK
                </v-btn>
              </v-date-picker>
            </v-menu>
          </v-col>
          <v-col cols="1">
            <v-btn icon>
              <v-icon color="grey lighten-1">mdi-information</v-icon>
            </v-btn>
          </v-col>
          <v-col cols="1">
            <v-btn icon>
              <v-icon color="grey lighten-1">mdi-information</v-icon>
            </v-btn>
          </v-col>
        </v-row>
      </v-list-item-action>
    </v-list-item>
    <v-chart class="chart" :option="option" autoresize />
    <v-card-text>
      <hr />
      <v-icon small>mdi-clock</v-icon>
      <span> Just Updated</span>
    </v-card-text>
  </v-card>
</template>

<script>
import { use } from "echarts/core";
import { CanvasRenderer } from "echarts/renderers";
import { LineChart } from "echarts/charts";
import {
  TitleComponent,
  TooltipComponent,
  LegendComponent,
  CalendarComponent,
} from "echarts/components";
import VChart, { THEME_KEY } from "vue-echarts";

use([
  CanvasRenderer,
  LineChart,
  TitleComponent,
  TooltipComponent,
  LegendComponent,
  CalendarComponent,
]);

function randomData() {
  now = new Date(+now + oneDay);
  value = Math.random() * 600;
  return {
    name: now.toString(),
    value: [
      [now.getFullYear(), now.getMonth() + 1, now.getDate()].join("/"),
      Math.round(value),
    ],
  };
}

var data = [];
var now = +new Date(2020, 9, 3);
var oneDay = 24 * 3600 * 1000;
var value = Math.random() * 1000;
for (var i = 0; i < 200; i++) {
  data.push(randomData());
}

export default {
  name: "HelloWorld",
  components: {
    VChart,
  },
  provide: {
    [THEME_KEY]: "light",
  },
  data() {
    return {
      option: {
        grid: {
          left: "3%",
          top: "3%",
          right: "1%",
          bottom: "7%",
        },
        tooltip: {
          trigger: "axis",
          formatter: function (params) {
            params = params[0];
            var date = new Date(params.name);
            return (
              date.getDate() +
              "/" +
              (date.getMonth() + 1) +
              "/" +
              date.getFullYear() +
              " : " +
              params.value[1]
            );
          },
          axisPointer: {
            animation: false,
          },
        },
        toolbox: {
          feature: {
            dataZoom: {
              yAxisIndex: "none",
            },
            restore: {},
            saveAsImage: {},
          },
        },
        xAxis: {
          type: "time",
          boundaryGap: false,
        },
        yAxis: {
          type: "value",
          boundaryGap: false,
        },
        dataZoom: [
          {
            type: "inside",
            start: 0,
            end: 20,
          },
          {
            start: 0,
            end: 20,
          },
        ],
        series: [
          {
            name: "User",
            type: "line",
            smooth: true,
            symbol: "none",
            // areaStyle: {},
            data: data,
          },
        ],
      },
      dateTo: new Date().toISOString().substr(0, 10),
      menuTo: false,
      dateFrom: new Date().toISOString().substr(0, 10),
      menuFrom: false,
    };
  },
};
</script>

<style scoped>
.chart {
  height: 300px;
}
.v-list-item__action {
  padding: 18px 4px 0px 0px;
  margin: 0px 0px;
}
</style>
